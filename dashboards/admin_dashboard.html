<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

  <!-- Navbar -->
  <header class="bg-white shadow p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold text-indigo-600">PixelForge Admin Dashboard</h1>
    <button id="logoutBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-1 rounded">Logout</button>
  </header>

  <!-- Content -->
  <div class="flex flex-1">
    <!-- Sidebar -->
    <aside class="w-64 bg-white shadow-md p-4 space-y-4">
      <p class="text-gray-700 font-semibold">Navigation</p>
      <nav class="space-y-2">
        <a href="#users" class="block text-indigo-700 hover:underline">User Management</a>
        <a href="#projects" class="block text-indigo-700 hover:underline">Project Management</a>
        <a href="#documents" class="block text-indigo-700 hover:underline">Documents</a>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-6 space-y-10">

      <!-- Welcome Section -->
      <section>
        <h2 class="text-2xl font-bold text-gray-800">Welcome, Admin</h2>
        <p class="text-gray-600">You have full control over users, projects, and documents.</p>
      </section>

      <!-- User Management -->
      <section id="users">
        <h3 class="text-xl font-semibold text-indigo-600 mb-4">User Management</h3>
        <div id="userList" class="bg-white p-4 rounded shadow">
          <p class="text-gray-500">Loading users...</p>
        </div>
      </section>

      <!-- Project Management -->
      <section id="projects">
        <h3 class="text-xl font-semibold text-indigo-600 mb-4">Project Management</h3>
        <div id="projectList" class="bg-white p-4 rounded shadow">
          <p class="text-gray-500">Loading projects...</p>
        </div>
      </section>

      <!-- Document Management -->
      <section id="documents">
        <h3 class="text-xl font-semibold text-indigo-600 mb-4">Document Management</h3>
        <div id="documentList" class="bg-white p-4 rounded shadow">
          <p class="text-gray-500">Loading documents...</p>
        </div>
      </section>

    </main>
  </div>

  <script>
    const logoutBtn = document.getElementById("logoutBtn");

    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("access");
      localStorage.removeItem("refresh");
      window.location.href = "../login.html";
    });

    const accessToken = localStorage.getItem("access");
    if (!accessToken) {
      window.location.href = "login.html";
    }

    // Decode JWT (basic, no validation) to check role
    function parseJwt(token) {
      try {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        return JSON.parse(decodeURIComponent(atob(base64).split('').map(c =>
          '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)
        ).join('')));
      } catch (e) {
        return null;
      }
    }

    const payload = parseJwt(accessToken);
    if (!payload || payload.role !== "admin") {
      alert("Unauthorized access");
      window.location.href = "login.html";
    }

    // TODO: Fetch and populate Users, Projects, and Documents
    // Example:
    // fetch("/api/users/", { headers: { Authorization: `Bearer ${accessToken}` } })

  </script>
</body>
</html>
